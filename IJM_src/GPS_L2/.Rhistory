library(moveHMM)
library(ggplot2)
wrapCor = function(cor) {corWrap<-ifelse(cor>180,cor-360,cor);return(corWrap)}
df = read.csv(file = "/Users/ian/Library/CloudStorage/GoogleDrive-ian.maywar@stonybrook.edu/.shortcut-targets-by-id/1-mLOKt79AsOpkCFrunvcUj54nuqPInxf/THORNE_LAB/Data/Albatross/NEW_STRUCTURE/L1/Bird_Island/Tag_Data/GPS/GPS_Catlog/2019_2020/2_buffer2km/BBAL_20191130_O596_GPS_L1_2.csv")
df$datetime <- as.POSIXct(df$datetime, format = "%Y-%m-%d %H:%M:%S", tz = "GMT")
df$lon <- wrapCor(df$lon)
names(df) <- c("ID",   "date", "lon",  "lat" )
data = prepData(
df,
type = "LL",
coordNames = c("lon", "lat"),
LLangle = TRUE
)
## initial parameters for gamma and von Mises distributions. See Michelot vignette
## TWO STATE MODEL
mu0 <- c(0.2,1) #(state1,state2)
sigma0 <- c(0.2,0.5) #(state1,state2)
stepPar0 <- c(mu0,sigma0)
angleMean0 <- c(pi,0)
kappa0 <- c(1,4) # angle concentration
anglePar0 <- c(angleMean0,kappa0)
m <- fitHMM(data=data,
nbStates = 2,
stepPar0 = stepPar0,
anglePar0 = anglePar0)
# Plot the results #
plot(m, plotCI = TRUE)
df = read.csv(file = "/Users/ian/Library/CloudStorage/GoogleDrive-ian.maywar@stonybrook.edu/.shortcut-targets-by-id/1-mLOKt79AsOpkCFrunvcUj54nuqPInxf/THORNE_LAB/Data/Albatross/NEW_STRUCTURE/L1/Bird_Island/Tag_Data/GPS/GPS_Catlog/2019_2020/2_buffer2km/BBAL_20191202_O874_GPS_L1_2.csv")
df$datetime <- as.POSIXct(df$datetime, format = "%Y-%m-%d %H:%M:%S", tz = "GMT")
df$lon <- wrapCor(df$lon)
names(df) <- c("ID",   "date", "lon",  "lat" )
data = prepData(
df,
type = "LL",
coordNames = c("lon", "lat"),
LLangle = TRUE
)
## initial parameters for gamma and von Mises distributions. See Michelot vignette
## TWO STATE MODEL
mu0 <- c(0.2,1) #(state1,state2)
sigma0 <- c(0.2,0.5) #(state1,state2)
stepPar0 <- c(mu0,sigma0)
angleMean0 <- c(pi,0)
kappa0 <- c(1,4) # angle concentration
anglePar0 <- c(angleMean0,kappa0)
m <- fitHMM(data=data,
nbStates = 2,
stepPar0 = stepPar0,
anglePar0 = anglePar0)
# Plot the results #
plot(m, plotCI = TRUE)
